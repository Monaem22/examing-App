import{r as l,A as v,j as e,L as w,f as x,k as E,l as C,y as a}from"./index-BU-rm2uI.js";import{H as S}from"./Helmet-CYjTrV5H.js";import{a as i}from"./api-DTyocR7z.js";import{I as k}from"./index-mYDvtZSz.js";import{l as A}from"./react-confirm-alert-C6ltwXRs.js";function G(){const{setExamId:u}=l.useContext(v),[h,n]=l.useState(!1),[r,d]=l.useState([]),[o,j]=l.useState(""),[c,f]=l.useState("");async function g(){try{n(!0);let{data:s}=await i.get("/api/exam/get-all-exam");d(s.data),a.success("تم جلب جميع الامتحانات!"),n(!1)}catch(s){n(!1),s.response&&s.response.data.message==="لا يوجد امتحانات"?a.info("لا يوجد امتحانات متاحة حاليًا."):a.error("حدثت مشكلة أثناء جلب جميع الامتحانات!")}}function p(s){u(s),sessionStorage.setItem("ExamId",s)}async function N(s){A.confirmAlert({title:"تأكيد الحذف",message:"هل أنت متأكد أنك تريد حذف هذا الامتحان؟",buttons:[{label:"نعم",className:"confirm-delete-btn",onClick:async()=>{try{await i.delete(`/api/exam/delete-exam/${s}`),a.success("تم حذف الامتحان بنجاح."),d(t=>t.filter(y=>y._id!==s)),n(!1)}catch{a.error("حدثت مشكلة أثناء حذف الامتحان!"),n(!1)}}},{label:"إلغاء",className:"confirm-cancel-btn",onClick:()=>console.log("تم الإلغاء")}]})}async function b(s){try{await i.patch(`/api/exam/reset-valid-students/${s}`),a.success("تمت إضافة الطلاب المتأخرين بنجاح.")}catch{a.error("حدثت مشكلة أثناء إضافة الطلاب المتأخرين!")}}l.useEffect(()=>{g()},[]);const m=r.filter(s=>s.title.includes(o)&&(c===""||s.grade===c));return h?e.jsx(w,{}):e.jsxs(e.Fragment,{children:[e.jsx(S,{children:e.jsx("title",{children:"جميع الامتحانات"})}),e.jsx("section",{className:"all-exams admins my-5 py-3",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3 mt-2",children:[e.jsx("h4",{className:"fw-bold dash-header mt-3",children:"📚 جميع الامتحانات :"}),e.jsx(x,{to:"/admin-dashboard",className:"redirect-link",children:e.jsxs("button",{className:"btn px-4 rounded-0 fs-6",children:["الرجوع الى لوحه التحكم"," ",e.jsx(k,{size:18,className:"mx-2"})]})})]}),e.jsxs("div",{className:"d-flex mb-3 gap-3 justify-content-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"🔍 ابحث عن امتحان...",value:o,onChange:s=>j(s.target.value)})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("select",{className:"form-select",value:c,onChange:s=>f(s.target.value),children:[e.jsx("option",{value:"",children:"اختر الصف"}),Array.from(new Set(r.map(s=>s.grade))).map((s,t)=>e.jsx("option",{value:s,children:s},t))]})})]}),e.jsx("div",{className:"row g-4",children:m.length>0?m.map((s,t)=>e.jsx("div",{className:"col-lg-4 col-md-6",children:e.jsxs("div",{className:"card p-2 shadow-sm rounded-3",onClick:()=>p(s._id),children:[e.jsxs("div",{className:"card-header d-flex align-items-center justify-content-between text-white fw-bold",children:[e.jsxs("p",{className:"mt-3",children:["امتحان #",t+1," "]}),e.jsx("button",{className:"btn btn-sm bg-success",onClick:()=>b(s._id),children:"إضافة الطلاب المتأخرين"})]}),e.jsxs("ul",{className:"list-group list-group-flush mt-2",children:[e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"📌 العنوان:"})," ",s.title]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"📚 الصف:"})," ",s.grade]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"📅 التاريخ:"})," ",s.date]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"⏰ الوقت:"})," ",s.time]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"⌛ المدة:"})," ",s.duration]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"❓ عدد الأسئلة:"})," ",s.totalQuestions]}),e.jsxs("li",{className:"list-group-item",children:[e.jsx("strong",{className:"text-muted",children:"🔢 كود الامتحان:"})," ",s.examCode]})]}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx(x,{to:"/exam-details",className:"text-decoration-none",children:e.jsxs("button",{className:"btn btn-sm d-flex align-items-center justify-content-center gap-1 mt-2",children:["تعديل الامتحان ",e.jsx(E,{})]})}),e.jsxs("button",{className:"btn btn-sm bg-danger d-flex align-items-center justify-content-center gap-1 mt-2",onClick:()=>N(s._id),children:["حذف ",e.jsx(C,{})]})]})]})},s._id)):e.jsx("div",{className:"col-12 text-center text-danger fw-bold py-2",children:e.jsx("p",{children:"لا توجد امتحانات متاحة حاليًا."})})})]})})]})}export{G as default};
